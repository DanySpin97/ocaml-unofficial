# Copyright 2009 A Frederick Christensen <fauxmight@nosocomia.com>
# Distributed under the terms of the GNU General Public License v2

SUMMARY="Preprocessor-pretty-printer of OCaml"

HOMEPAGE="http://pauillac.inria.fr/~ddr/camlp5/"
DOWNLOADS="http://pauillac.inria.fr/~ddr/camlp5/distrib/src/${PNV}.tgz"

LICENCES="BSD-3"
SLOT="0"
PLATFORMS="~amd64 ~x86"
MYOPTIONS="
    strict [[ description = [ new sytax tree - breaks compatibility with older syntax tree ] ]]
"

DEPENDENCIES="
    build+run:
        dev-lang/ocaml
"

BUGS_TO="fauxmight@nosocomia.com"

DEFAULT_SRC_COMPILE_PARAMS=( world.opt )

# This OCaml specific configure file behaves very unlike
# 'normal' (read autotools) configure files. Options are in the
# form "--option value" rather than "--option=value"
# (' ' instead of '=')
src_configure() {
    option strict && CAMLP5_MODE="--strict" || CAMLP5_MODE="--transitional"
    edo ./configure \
        --prefix /usr \
        --bindir /usr/bin \
        --mandir /usr/share/man \
        --libdir /usr/${LIBDIR} \
        "$CAMLP5_MODE"
}

